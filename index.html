<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keiran</title>
<meta name="description" content="Keiran — builder of Mirage, GG, and Sophie.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:'Space Grotesk',sans-serif;color:#fff;-webkit-font-smoothing:antialiased}
canvas#bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
#ui{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none}
#title{position:absolute;top:40px;left:50%;transform:translateX(-50%);font-size:clamp(28px,5vw,48px);font-weight:700;letter-spacing:6px;opacity:0.25;transition:opacity 0.8s ease;pointer-events:auto;user-select:none;text-transform:uppercase}
#title:hover{opacity:0.7}
#sound-toggle{position:absolute;bottom:30px;right:30px;pointer-events:auto;cursor:pointer;width:44px;height:44px;border:1px solid rgba(255,255,255,0.15);border-radius:50%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.4);backdrop-filter:blur(8px);transition:border-color 0.3s,opacity 0.3s;opacity:0.5;z-index:10}
#sound-toggle:hover{opacity:1;border-color:rgba(255,255,255,0.4)}
#sound-toggle svg{width:20px;height:20px;fill:#fff}
#yt-container{position:absolute;top:-9999px;left:-9999px;width:1px;height:1px;overflow:hidden}
/* Detail overlay */
#overlay{position:fixed;top:0;left:0;width:100%;height:100%;z-index:5;pointer-events:none;opacity:0;transition:opacity 0.5s ease}
#overlay.active{pointer-events:auto;opacity:1}
#overlay-bg{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);cursor:pointer}
#detail{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-width:560px;width:90%;text-align:center;opacity:0;transform:translate(-50%,-50%) scale(0.9);transition:opacity 0.5s ease 0.1s,transform 0.5s ease 0.1s}
#overlay.active #detail{opacity:1;transform:translate(-50%,-50%) scale(1)}
#detail h2{font-size:clamp(22px,4vw,36px);font-weight:700;margin-bottom:8px;letter-spacing:2px}
#detail .year{font-size:14px;opacity:0.4;margin-bottom:16px;letter-spacing:1px}
#detail .desc{font-size:clamp(14px,2.5vw,17px);line-height:1.6;opacity:0.7;margin-bottom:12px;font-weight:400}
#detail .raised{font-size:14px;opacity:0.35;margin-bottom:24px}
#detail .links{display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-bottom:24px}
#detail .links a{color:#fff;text-decoration:none;font-size:13px;letter-spacing:1px;padding:8px 20px;border:1px solid rgba(255,255,255,0.2);border-radius:24px;transition:all 0.3s;font-weight:400}
#detail .links a:hover{background:rgba(255,255,255,0.08);border-color:rgba(255,255,255,0.5)}
#close-btn{position:absolute;top:-50px;right:-10px;width:36px;height:36px;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;border:1px solid rgba(255,255,255,0.15);transition:border-color 0.3s}
#close-btn:hover{border-color:rgba(255,255,255,0.5)}
#close-btn::before,#close-btn::after{content:'';position:absolute;width:14px;height:1px;background:#fff;opacity:0.6}
#close-btn::before{transform:rotate(45deg)}
#close-btn::after{transform:rotate(-45deg)}
/* Creature labels */
.creature-label{position:absolute;pointer-events:none;font-size:13px;letter-spacing:3px;text-transform:uppercase;opacity:0;transition:opacity 0.4s ease;white-space:nowrap;font-weight:700}
@media(max-width:600px){
  #title{top:24px;letter-spacing:4px}
  #sound-toggle{bottom:20px;right:20px}
}
</style>
</head>
<body>
<canvas id="bg"></canvas>
<div id="ui">
  <div id="title">Keiran</div>
  <div id="sound-toggle" aria-label="Toggle sound">
    <svg id="sound-icon" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
  </div>
  <div id="yt-container"></div>
</div>
<div id="overlay">
  <div id="overlay-bg"></div>
  <div id="detail">
    <div id="close-btn"></div>
    <h2 id="d-title"></h2>
    <div class="year" id="d-year"></div>
    <div class="desc" id="d-desc"></div>
    <div class="raised" id="d-raised"></div>
    <div class="links" id="d-links"></div>
  </div>
</div>

<script>
// ===== PROJECT DATA =====
const projects = [
  {
    name: 'Mirage',
    year: '2022 – 2024',
    desc: 'AR meets crypto. A persistent multiplayer AR experience — create, explore, and collect location-based digital art with token incentives.',
    raised: 'Raised $1.3M from Delphi Digital',
    links: [
      { label: 'Website', url: 'https://mirage.ar/' },
      { label: 'App Store', url: 'https://apps.apple.com/us/app/mirage-studio/id1671886519' }
    ],
    color: [0, 180, 255],      // cyan-blue bioluminescence
    glowColor: 'rgba(0,180,255,',
    size: 1.0
  },
  {
    name: 'GG',
    year: '2024',
    desc: 'PokemonGo meets memecoins. A crypto hunger games that pulled 110K followers in 3 days. Real-time game streaming meets onchain chaos.',
    raised: 'Raised $700K',
    links: [
      { label: 'Watch Video', url: 'https://x.com/NashGGs/status/1808877799790248246' }
    ],
    color: [0, 255, 140],      // green bioluminescence
    glowColor: 'rgba(0,255,140,',
    size: 0.85
  },
  {
    name: 'Sophie',
    year: '2024 – 2025',
    desc: 'The first AI companion on Meta Quest. Unreal MetaHuman with ElevenLabs voice. Shipped through Meta\'s platform review. Generated revenue.',
    raised: 'Revenue-generating',
    links: [
      { label: 'Meta Quest', url: 'https://www.meta.com/experiences/sophie/8890839327601249/' }
    ],
    color: [200, 100, 255],    // purple bioluminescence
    glowColor: 'rgba(200,100,255,',
    size: 0.9
  }
];

// ===== CANVAS SETUP =====
const canvas = document.getElementById('bg');
const ctx = canvas.getContext('2d');
let W, H, dpr;
let mouseX = -9999, mouseY = -9999;
let touching = false;

function resize() {
  dpr = Math.min(window.devicePixelRatio || 1, 2);
  W = window.innerWidth;
  H = window.innerHeight;
  canvas.width = W * dpr;
  canvas.height = H * dpr;
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  // Reposition creatures
  positionCreatures();
}
window.addEventListener('resize', resize);

// ===== PARTICLES =====
const particles = [];
const PARTICLE_COUNT = 180;

function initParticles() {
  particles.length = 0;
  for (let i = 0; i < PARTICLE_COUNT; i++) {
    particles.push({
      x: Math.random() * W,
      y: Math.random() * H,
      vx: (Math.random() - 0.5) * 0.15,
      vy: (Math.random() - 0.5) * 0.15 - 0.05,
      r: Math.random() * 1.8 + 0.3,
      alpha: Math.random() * 0.4 + 0.05,
      pulse: Math.random() * Math.PI * 2,
      pulseSpeed: Math.random() * 0.008 + 0.003,
      hue: Math.random() * 60 + 170 // 170-230 range (blue-cyan)
    });
  }
}

function updateParticles() {
  for (const p of particles) {
    p.pulse += p.pulseSpeed;
    const pa = p.alpha + Math.sin(p.pulse) * 0.15;

    // Mouse interaction
    const dx = p.x - mouseX;
    const dy = p.y - mouseY;
    const dist = Math.sqrt(dx * dx + dy * dy);
    if (dist < 150) {
      const force = (150 - dist) / 150 * 0.3;
      p.vx += (dx / dist) * force;
      p.vy += (dy / dist) * force;
    }

    p.vx *= 0.98;
    p.vy *= 0.98;
    p.x += p.vx;
    p.y += p.vy;

    // Wrap
    if (p.x < -10) p.x = W + 10;
    if (p.x > W + 10) p.x = -10;
    if (p.y < -10) p.y = H + 10;
    if (p.y > H + 10) p.y = -10;

    // Draw
    const a = Math.max(0, Math.min(1, pa));
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
    ctx.fillStyle = `hsla(${p.hue},80%,70%,${a})`;
    ctx.fill();

    // Glow
    if (p.r > 1) {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r * 3, 0, Math.PI * 2);
      ctx.fillStyle = `hsla(${p.hue},80%,60%,${a * 0.15})`;
      ctx.fill();
    }
  }
}

// ===== CREATURES =====
const creatures = [];
let hoveredCreature = null;
let activeCreature = null;

function positionCreatures() {
  const isMobile = W < 600;
  const positions = isMobile
    ? [
        { x: W * 0.5, y: H * 0.28 },
        { x: W * 0.3, y: H * 0.52 },
        { x: W * 0.7, y: H * 0.73 }
      ]
    : [
        { x: W * 0.22, y: H * 0.45 },
        { x: W * 0.52, y: H * 0.55 },
        { x: W * 0.78, y: H * 0.4 }
      ];

  for (let i = 0; i < projects.length; i++) {
    if (!creatures[i]) {
      creatures[i] = {
        baseX: positions[i].x,
        baseY: positions[i].y,
        x: positions[i].x,
        y: positions[i].y,
        phase: Math.random() * Math.PI * 2,
        tentaclePhase: Math.random() * Math.PI * 2,
        hoverAmt: 0,
        project: projects[i]
      };
    } else {
      creatures[i].baseX = positions[i].x;
      creatures[i].baseY = positions[i].y;
    }
  }
}

function drawCreature(c, time) {
  const p = c.project;
  const baseSize = (W < 600 ? 40 : 60) * p.size;
  const hover = c.hoverAmt;
  const size = baseSize * (1 + hover * 0.2);
  const [r, g, b] = p.color;

  // Drift
  c.phase += 0.004;
  c.tentaclePhase += 0.015;
  c.x = c.baseX + Math.sin(c.phase) * 15 + Math.cos(c.phase * 0.7) * 8;
  c.y = c.baseY + Math.cos(c.phase * 0.8) * 12 + Math.sin(c.phase * 0.5) * 6;

  const pulse = 0.7 + Math.sin(time * 0.0015 + c.phase) * 0.3;
  const glowAlpha = (0.12 + hover * 0.15) * pulse;
  const bodyAlpha = (0.35 + hover * 0.35) * pulse;

  ctx.save();
  ctx.translate(c.x, c.y);

  // Outer glow
  const grad = ctx.createRadialGradient(0, 0, 0, 0, 0, size * 3);
  grad.addColorStop(0, `rgba(${r},${g},${b},${glowAlpha})`);
  grad.addColorStop(0.4, `rgba(${r},${g},${b},${glowAlpha * 0.3})`);
  grad.addColorStop(1, 'rgba(0,0,0,0)');
  ctx.beginPath();
  ctx.arc(0, 0, size * 3, 0, Math.PI * 2);
  ctx.fillStyle = grad;
  ctx.fill();

  // Bell (jellyfish dome) — organic shape using bezier curves
  ctx.beginPath();
  const bellH = size * 0.7;
  const bellW = size * 0.9;
  const wobble1 = Math.sin(c.tentaclePhase) * size * 0.04;
  const wobble2 = Math.cos(c.tentaclePhase * 1.3) * size * 0.03;

  ctx.moveTo(-bellW, size * 0.1);
  ctx.bezierCurveTo(-bellW + wobble1, -bellH * 0.5, -bellW * 0.3, -bellH - wobble2, 0, -bellH);
  ctx.bezierCurveTo(bellW * 0.3, -bellH + wobble2, bellW - wobble1, -bellH * 0.5, bellW, size * 0.1);
  ctx.bezierCurveTo(bellW * 0.6, size * 0.2, -bellW * 0.6, size * 0.2, -bellW, size * 0.1);

  const bellGrad = ctx.createRadialGradient(0, -bellH * 0.3, 0, 0, -bellH * 0.3, size);
  bellGrad.addColorStop(0, `rgba(${r},${g},${b},${bodyAlpha * 0.8})`);
  bellGrad.addColorStop(0.5, `rgba(${r},${g},${b},${bodyAlpha * 0.3})`);
  bellGrad.addColorStop(1, `rgba(${r},${g},${b},0)`);
  ctx.fillStyle = bellGrad;
  ctx.fill();

  // Inner luminous core
  const coreGrad = ctx.createRadialGradient(0, -bellH * 0.3, 0, 0, -bellH * 0.3, size * 0.35);
  coreGrad.addColorStop(0, `rgba(255,255,255,${bodyAlpha * 0.6})`);
  coreGrad.addColorStop(0.5, `rgba(${r},${g},${b},${bodyAlpha * 0.4})`);
  coreGrad.addColorStop(1, 'rgba(0,0,0,0)');
  ctx.beginPath();
  ctx.arc(0, -bellH * 0.3, size * 0.35, 0, Math.PI * 2);
  ctx.fillStyle = coreGrad;
  ctx.fill();

  // Tentacles
  const tentCount = 7;
  for (let t = 0; t < tentCount; t++) {
    const tx = -bellW * 0.7 + (bellW * 1.4 / (tentCount - 1)) * t;
    const tentLen = size * (0.8 + Math.sin(c.tentaclePhase + t * 0.8) * 0.3);
    const sway = Math.sin(c.tentaclePhase * 0.7 + t * 1.2) * size * 0.25;
    const sway2 = Math.cos(c.tentaclePhase * 0.5 + t * 0.9) * size * 0.15;

    ctx.beginPath();
    ctx.moveTo(tx, size * 0.1);
    ctx.bezierCurveTo(
      tx + sway * 0.3, size * 0.1 + tentLen * 0.3,
      tx + sway, size * 0.1 + tentLen * 0.6,
      tx + sway + sway2, size * 0.1 + tentLen
    );
    ctx.strokeStyle = `rgba(${r},${g},${b},${bodyAlpha * (0.2 + Math.sin(c.tentaclePhase + t) * 0.1)})`;
    ctx.lineWidth = 1.5 - t * 0.05;
    ctx.stroke();

    // Glowing dots along tentacles
    if (t % 2 === 0) {
      const dotY = size * 0.1 + tentLen * (0.4 + Math.sin(c.tentaclePhase * 0.3 + t) * 0.15);
      const dotX = tx + sway * 0.4;
      ctx.beginPath();
      ctx.arc(dotX, dotY, 1.5, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(${r},${g},${b},${bodyAlpha * 0.6})`;
      ctx.fill();
    }
  }

  // Trailing filaments (longer, thinner)
  for (let f = 0; f < 3; f++) {
    const fx = -bellW * 0.3 + bellW * 0.3 * f;
    const fLen = size * (1.5 + Math.sin(c.tentaclePhase * 0.4 + f * 2) * 0.4);
    const fSway = Math.sin(c.tentaclePhase * 0.3 + f * 1.5) * size * 0.4;

    ctx.beginPath();
    ctx.moveTo(fx, size * 0.15);
    ctx.bezierCurveTo(
      fx + fSway * 0.2, size * 0.15 + fLen * 0.25,
      fx + fSway * 0.7, size * 0.15 + fLen * 0.5,
      fx + fSway, size * 0.15 + fLen
    );
    ctx.strokeStyle = `rgba(${r},${g},${b},${bodyAlpha * 0.08})`;
    ctx.lineWidth = 0.5;
    ctx.stroke();
  }

  ctx.restore();

  // Label
  if (hover > 0.1) {
    ctx.save();
    ctx.globalAlpha = hover;
    ctx.font = '700 13px "Space Grotesk"';
    ctx.textAlign = 'center';
    ctx.fillStyle = `rgba(${r},${g},${b},${hover})`;
    ctx.letterSpacing = '3px';
    ctx.fillText(p.name.toUpperCase(), c.x, c.y - size * 1.4);
    ctx.restore();
  }
}

function hitTestCreature(mx, my) {
  for (let i = creatures.length - 1; i >= 0; i--) {
    const c = creatures[i];
    const size = (W < 600 ? 40 : 60) * c.project.size;
    const dx = mx - c.x;
    const dy = my - c.y;
    if (dx * dx + dy * dy < (size * 1.5) * (size * 1.5)) return c;
  }
  return null;
}

// ===== DETAIL OVERLAY =====
const overlay = document.getElementById('overlay');
const overlayBg = document.getElementById('overlay-bg');

function showDetail(c) {
  activeCreature = c;
  const p = c.project;
  document.getElementById('d-title').textContent = p.name;
  document.getElementById('d-year').textContent = p.year;
  document.getElementById('d-desc').textContent = p.desc;
  document.getElementById('d-raised').textContent = p.raised;

  const linksEl = document.getElementById('d-links');
  linksEl.innerHTML = '';
  for (const l of p.links) {
    const a = document.createElement('a');
    a.href = l.url;
    a.target = '_blank';
    a.rel = 'noopener';
    a.textContent = l.label;
    linksEl.appendChild(a);
  }

  // Color the title
  const [r, g, b] = p.color;
  document.getElementById('d-title').style.color = `rgb(${r},${g},${b})`;

  overlay.classList.add('active');
}

function hideDetail() {
  overlay.classList.remove('active');
  activeCreature = null;
}

overlayBg.addEventListener('click', hideDetail);
document.getElementById('close-btn').addEventListener('click', hideDetail);
document.addEventListener('keydown', e => { if (e.key === 'Escape') hideDetail(); });

// ===== INPUT =====
canvas.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
canvas.addEventListener('mouseleave', () => { mouseX = -9999; mouseY = -9999; });
canvas.addEventListener('click', e => {
  const c = hitTestCreature(e.clientX, e.clientY);
  if (c) showDetail(c);
});

canvas.addEventListener('touchstart', e => {
  const t = e.touches[0];
  mouseX = t.clientX;
  mouseY = t.clientY;
  touching = true;
}, { passive: true });
canvas.addEventListener('touchmove', e => {
  const t = e.touches[0];
  mouseX = t.clientX;
  mouseY = t.clientY;
}, { passive: true });
canvas.addEventListener('touchend', e => {
  if (touching) {
    const c = hitTestCreature(mouseX, mouseY);
    if (c) showDetail(c);
  }
  setTimeout(() => { mouseX = -9999; mouseY = -9999; touching = false; }, 100);
}, { passive: true });

// ===== SOUND =====
let ytPlayer = null;
let soundOn = false;
const soundToggle = document.getElementById('sound-toggle');
const soundIcon = document.getElementById('sound-icon');
const muteIcon = '<path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>';
const playIcon = '<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>';

function loadYTAPI() {
  if (window.YT) return;
  const tag = document.createElement('script');
  tag.src = 'https://www.youtube.com/iframe_api';
  document.head.appendChild(tag);
}

window.onYouTubeIframeAPIReady = function() {
  ytPlayer = new YT.Player('yt-container', {
    height: '1', width: '1',
    videoId: 'HhZaHf8RP6g',
    playerVars: { autoplay: 0, loop: 1, playlist: 'HhZaHf8RP6g', controls: 0 },
    events: {
      onReady: function(e) {
        if (soundOn) { e.target.playVideo(); }
      },
      onStateChange: function(e) {
        // Loop
        if (e.data === YT.PlayerState.ENDED) {
          e.target.playVideo();
        }
      }
    }
  });
};

soundToggle.addEventListener('click', () => {
  soundOn = !soundOn;
  soundIcon.innerHTML = soundOn ? playIcon : muteIcon;
  if (!window.YT) { loadYTAPI(); return; }
  if (!ytPlayer) return;
  if (soundOn) { ytPlayer.playVideo(); }
  else { ytPlayer.pauseVideo(); }
});

// Start with mute icon state (show play icon = sound off initially... let's use mute icon)
soundIcon.innerHTML = muteIcon;

// ===== RENDER LOOP =====
let lastTime = 0;

function render(time) {
  ctx.clearRect(0, 0, W, H);

  // Subtle depth gradient
  const bgGrad = ctx.createRadialGradient(W / 2, H / 2, 0, W / 2, H / 2, Math.max(W, H) * 0.7);
  bgGrad.addColorStop(0, 'rgba(5,8,18,1)');
  bgGrad.addColorStop(1, 'rgba(0,0,0,1)');
  ctx.fillStyle = bgGrad;
  ctx.fillRect(0, 0, W, H);

  // Particles
  updateParticles();

  // Creatures
  const hit = hitTestCreature(mouseX, mouseY);
  for (const c of creatures) {
    const isHovered = c === hit && !activeCreature;
    c.hoverAmt += (isHovered ? 0.04 : -0.04);
    c.hoverAmt = Math.max(0, Math.min(1, c.hoverAmt));
    drawCreature(c, time);
  }

  // Cursor
  canvas.style.cursor = hit && !activeCreature ? 'pointer' : 'default';

  requestAnimationFrame(render);
}

// ===== INIT =====
resize();
initParticles();
requestAnimationFrame(render);
</script>
</body>
</html>
